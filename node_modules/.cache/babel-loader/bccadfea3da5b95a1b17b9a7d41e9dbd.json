{"remainingRequest":"C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\itryl\\Desktop\\final_books\\src\\views\\home\\Home.vue?vue&type=template&id=3dd2e005&scoped=true","dependencies":[{"path":"C:\\Users\\itryl\\Desktop\\final_books\\src\\views\\home\\Home.vue","mtime":1623637689777},{"path":"C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1616796459000},{"path":"C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\itryl\\Desktop\\final_books\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1616796459000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVzb2x2ZUNvbXBvbmVudCBhcyBfcmVzb2x2ZUNvbXBvbmVudCwgd2l0aEN0eCBhcyBfd2l0aEN0eCwgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCB2U2hvdyBhcyBfdlNob3csIHdpdGhEaXJlY3RpdmVzIGFzIF93aXRoRGlyZWN0aXZlcywgY3JlYXRlQ29tbWVudFZOb2RlIGFzIF9jcmVhdGVDb21tZW50Vk5vZGUsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVCbG9jayBhcyBfY3JlYXRlQmxvY2ssIHdpdGhTY29wZUlkIGFzIF93aXRoU2NvcGVJZCwgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCnZhciBfd2l0aElkID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgiZGF0YS12LTNkZDJlMDA1Iik7CgpfcHVzaFNjb3BlSWQoImRhdGEtdi0zZGQyZTAwNSIpOwoKdmFyIF9ob2lzdGVkXzEgPSB7CiAgY2xhc3M6ICJtYWluIgp9Owp2YXIgX2hvaXN0ZWRfMiA9IHsKICBjbGFzczogIndyYXBwZXIiCn07CnZhciBfaG9pc3RlZF8zID0gewogIGNsYXNzOiAiY29udGVudCIKfTsKdmFyIF9ob2lzdGVkXzQgPSB7CiAgcmVmOiAiYmFucmVmIgp9OwoKX3BvcFNjb3BlSWQoKTsKCmV4cG9ydCB2YXIgcmVuZGVyID0gLyojX19QVVJFX18qL193aXRoSWQoZnVuY3Rpb24gKF9jdHgsIF9jYWNoZSwgJHByb3BzLCAkc2V0dXAsICRkYXRhLCAkb3B0aW9ucykgewogIHZhciBfY29tcG9uZW50X25hdl9iYXIgPSBfcmVzb2x2ZUNvbXBvbmVudCgibmF2LWJhciIpOwoKICB2YXIgX2NvbXBvbmVudF90YWJfY29udHJvbCA9IF9yZXNvbHZlQ29tcG9uZW50KCJ0YWItY29udHJvbCIpOwoKICB2YXIgX2NvbXBvbmVudF9ob21lX3N3aXBlciA9IF9yZXNvbHZlQ29tcG9uZW50KCJob21lLXN3aXBlciIpOwoKICB2YXIgX2NvbXBvbmVudF9yZWNvbW1lbmRfdmlldyA9IF9yZXNvbHZlQ29tcG9uZW50KCJyZWNvbW1lbmQtdmlldyIpOwoKICB2YXIgX2NvbXBvbmVudF9nb29kc19saXN0ID0gX3Jlc29sdmVDb21wb25lbnQoImdvb2RzLWxpc3QiKTsKCiAgdmFyIF9jb21wb25lbnRfYmFja190b3AgPSBfcmVzb2x2ZUNvbXBvbmVudCgiYmFjay10b3AiKTsKCiAgcmV0dXJuIF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfbmF2X2JhciwgbnVsbCwgewogICAgbGVmdDogX3dpdGhJZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0pLAogICAgXzogMQogICAgLyogU1RBQkxFICovCgogIH0pLCBfd2l0aERpcmVjdGl2ZXMoX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfdGFiX2NvbnRyb2wsIHsKICAgIHRpdGxlOiBbJ+eVhemUgCcsICfmtYHooYwnLCAn57K+6YCJJ10sCiAgICBvblRhYkNsaWNrOiAkc2V0dXAudGFiQ2xpY2sKICB9LCBudWxsLCA4CiAgLyogUFJPUFMgKi8KICAsIFsib25UYWJDbGljayJdKSwgW1tfdlNob3csICRzZXR1cC5pc1RhYkZpeGVkXV0pLCBfY3JlYXRlQ29tbWVudFZOb2RlKCLov5nmmK/mu5rliqjnmoTlpKfnm5LlrZDpg6jliIYiKSwgX2NyZWF0ZVZOb2RlKCJkaXYiLCBfaG9pc3RlZF8yLCBbX2NyZWF0ZVZOb2RlKCJkaXYiLCBfaG9pc3RlZF8zLCBbX2NyZWF0ZUNvbW1lbnRWTm9kZSgicmVm55So5LqO6I635Y+W6L2u5pKt5Zu+5ZKMYmFubmVy5LiA6LW355qE6auY5bqmIiksIF9jcmVhdGVWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfNCwgW19jcmVhdGVWTm9kZShfY29tcG9uZW50X2hvbWVfc3dpcGVyLCB7CiAgICBiYW5uZXJzOiAkc2V0dXAuYmFubmVycwogIH0sIG51bGwsIDgKICAvKiBQUk9QUyAqLwogICwgWyJiYW5uZXJzIl0pLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9yZWNvbW1lbmRfdmlldywgewogICAgcmVjb21tZW5kczogJHNldHVwLnJlY29tbWVuZHMKICB9LCBudWxsLCA4CiAgLyogUFJPUFMgKi8KICAsIFsicmVjb21tZW5kcyJdKV0sIDUxMgogIC8qIE5FRURfUEFUQ0ggKi8KICApLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF90YWJfY29udHJvbCwgewogICAgdGl0bGU6IFsn55WF6ZSAJywgJ+a1geihjCcsICfnsr7pgIknXSwKICAgIG9uVGFiQ2xpY2s6ICRzZXR1cC50YWJDbGljawogIH0sIG51bGwsIDgKICAvKiBQUk9QUyAqLwogICwgWyJvblRhYkNsaWNrIl0pLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9nb29kc19saXN0LCB7CiAgICBnb29kczogJHNldHVwLnNob3dHb29kcwogIH0sIG51bGwsIDgKICAvKiBQUk9QUyAqLwogICwgWyJnb29kcyJdKV0pXSksIF93aXRoRGlyZWN0aXZlcyhfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9iYWNrX3RvcCwgewogICAgb25CVG9wOiAkc2V0dXAuYlRvcAogIH0sIG51bGwsIDgKICAvKiBQUk9QUyAqLwogICwgWyJvbkJUb3AiXSksIFtbX3ZTaG93LCAkc2V0dXAuaXNTaG93QmFja1RvcF1dKV0pOwp9KTs="},{"version":3,"sources":["C:\\Users\\itryl\\Desktop\\final_books\\src\\views\\home\\Home.vue"],"names":[],"mappings":";;;;;;;AACS,EAAA,KAAK,EAAC;;;AAML,EAAA,KAAK,EAAC;;;AACL,EAAA,KAAK,EAAC;;;AAEL,EAAA,GAAG,EAAC;;;;;;;;;;;;;;;;;;uBATZ,YAAA,CAkBM,KAlBN,EAAA,UAAA,EAkBM,CAjBJ,YAAA,CAEU,kBAFV,EAEU,IAFV,EAEU;AADS,IAAA,IAAI,EAAA,OAAA,CAArB;AAAA,aAAiC,EAAjC;AAAA,KAAqB,CACb;;;;AAAA,GAFV,CAiBI,E,gBAdJ,YAAA,CAA8F,sBAA9F,EAA8F;AAA5D,IAAA,KAAK,EAAE,CAAA,IAAA,EAAA,IAAA,EAAA,IAAA,CAAqD;AAAlC,IAAA,UAAQ,EAAE,MAAA,CAAA;AAAwB,GAA9F,E,IAAA,E;;AAAA,I,cAAA,C,YAAqB,MAAA,CAAA,U,GAcjB,EAbJ,mBAAA,CAAA,YAAA,CAaI,EAZL,YAAA,CAUM,KAVN,EAAA,UAAA,EAUM,CATL,YAAA,CAQM,KARN,EAAA,UAAA,EAQM,CAPN,mBAAA,CAAA,wBAAA,CAOM,EANL,YAAA,CAGM,KAHN,EAAA,UAAA,EAGM,CAFL,YAAA,CAA+C,sBAA/C,EAA+C;AAAjC,IAAA,OAAO,EAAE,MAAA,CAAA;AAAwB,GAA/C,EAA8B,IAA9B,EAA8B;AAAA;AAA9B,IAA8B,CAAA,SAAA,CAA9B,CAEK,EADJ,YAAA,CAA0D,yBAA1D,EAA0D;AAAzC,IAAA,UAAU,EAAE,MAAA,CAAA;AAA6B,GAA1D,EAAuC,IAAvC,EAAuC;AAAA;AAAvC,IAAuC,CAAA,YAAA,CAAvC,CACI,CAHN,E;;AAAA,GAMK,EAFJ,YAAA,CAA2E,sBAA3E,EAA2E;AAA5D,IAAA,KAAK,EAAE,CAAA,IAAA,EAAA,IAAA,EAAA,IAAA,CAAqD;AAAlC,IAAA,UAAQ,EAAE,MAAA,CAAA;AAAwB,GAA3E,E,IAAA,E;;AAAA,I,cAAA,CAEI,EADJ,YAAA,CAA4C,qBAA5C,EAA4C;AAA/B,IAAA,KAAK,EAAE,MAAA,CAAA;AAAwB,GAA5C,EAA6B,IAA7B,EAA6B;AAAA;AAA7B,IAA6B,CAAA,OAAA,CAA7B,CACI,CARN,CASK,CAVN,CAYK,E,gBADN,YAAA,CAAyD,mBAAzD,EAAyD;AAAvB,IAAA,MAAI,EAAE,MAAA,CAAA;AAAiB,GAAzD,EAA4C,IAA5C,EAA4C;AAAA;AAA5C,IAA4C,CAAA,QAAA,CAA5C,C,EAA4C,C,SAA1B,MAAA,CAAA,a,CAA0B,C,CACtC,CAlBN,C","sourcesContent":["<template>\r\n    <div class=\"main\">\r\n      <nav-bar >\r\n        <template v-slot:left></template>\r\n      </nav-bar>\r\n      <tab-control v-show=\"isTabFixed\" :title=\"['畅销','流行','精选']\" @tabClick=\"tabClick\"></tab-control>\r\n      <!--这是滚动的大盒子部分-->\r\n     <div class=\"wrapper\">\r\n      <div class=\"content\">\r\n      <!--ref用于获取轮播图和banner一起的高度-->\r\n       <div ref=\"banref\">\r\n        <home-swiper :banners=\"banners\" ></home-swiper>\r\n         <recommend-view :recommends=\"recommends\"></recommend-view>\r\n       </div>\r\n        <tab-control  :title=\"['畅销','流行','精选']\" @tabClick=\"tabClick\"></tab-control>\r\n        <goods-list :goods=\"showGoods\"></goods-list>\r\n      </div>\r\n     </div>\r\n    <back-top v-show=\"isShowBackTop\" @bTop=\"bTop\"></back-top>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from \"components/common/NavBar/NavBar\";\r\nimport HomeSwiper from \"./childrenComps/HomeSwiper\";\r\nimport RecommendView from \"./childrenComps/RecommendView\";\r\nimport TabControl from \"components/content/tabControl/TabControl\";\r\nimport {getHomeAllData,getHomeGoods} from \"network/home\";\r\nimport {onMounted,ref,reactive,computed,watchEffect,nextTick} from \"vue\";\r\nimport GoodsList from \"components/content/goods/GoodsList\";\r\nimport BackTop from 'components/common/backTop/BackTop'\r\nimport BScroll from 'better-scroll'\r\n\r\nexport default {\r\n  name: \"Home\",\r\n  setup(){\r\n    const recommends=ref([])  //提前声明异步加载之前为空，否则页面会报错\r\n    //商品列表数据模型\r\n    const goods=reactive({\r\n          sales:{page:1,list:[]},\r\n          recommend:{page:1,list:[]},\r\n          new:{page:1,list:[]},\r\n    })\r\n\r\n    //轮播图数据\r\n    const banners=ref([])\r\n\r\n    //确定当前点击的是哪个选项卡 ，根据选项卡 向商品列表传递不同的值\r\n    let currentType=ref('sales')\r\n\r\n    //通过计算属性，将当前类型的数据传给goods-list组件\r\n    const showGoods=computed(()=>{\r\n      return goods[currentType.value].list\r\n    })\r\n\r\n    //定义一个bscroll\r\n    let bscroll=reactive({\r\n\r\n    })\r\n\r\n    //定义一个控制选项卡 显示隐藏的变量\r\n    let isTabFixed=ref(false)\r\n    let isShowBackTop=ref(false)\r\n    let banref=ref(null)\r\n\r\n    onMounted(()=>{\r\n      getHomeAllData().then(res=>{\r\n         recommends.value=res.goods.data\r\n        banners.value=res.slides\r\n      },err=>{})\r\n      getHomeGoods('sales').then(res=>{\r\n        goods.sales.list=res.goods.data\r\n      })\r\n      getHomeGoods('recommend').then(res=>{\r\n        goods.recommend.list=res.goods.data\r\n      })\r\n      getHomeGoods('new').then(res=>{\r\n        goods.new.list=res.goods.data\r\n      })\r\n\r\n      //创建BetterScroll对象\r\n       bscroll=new BScroll(document.querySelector('.wrapper'),{\r\n        probeType:3,  //0 1 2 3(只要运动就出发scroll事件)\r\n        click:true,    //滚动是否允许点击\r\n        pullUpLoad:true   //上拉加载更多\r\n      })\r\n      //触发滚动事件\r\n      bscroll.on('scroll',(position)=>{\r\n                 console.log(banref.value.offsetHeight)\r\n        if((-position.y)>banref.value.offsetHeight){\r\n          isTabFixed.value=true\r\n          isShowBackTop.value=true\r\n        }else{\r\n          isTabFixed.value=false\r\n          isShowBackTop.value=false\r\n        }\r\n      })\r\n\r\n      //下拉加载更多数据，触发pullUpload\r\n      bscroll.on('pullingUp',()=>{\r\n        console.log('上拉加载更多')\r\n        const  page=goods[currentType.value].page+1\r\n        getHomeGoods(currentType.value,page).then(res=>{\r\n          goods[currentType.value].list.push(...res.goods.data)\r\n          goods[currentType.value].page+=1\r\n        })\r\n        //完成上拉 ，等数据请求完成，要将数据展示出来\r\n        bscroll.finishPullUp()\r\n        // console.log(document.querySelector('.content').clientHeight)\r\n        // console.log(page)\r\n        //重新计算高度\r\n        bscroll.refresh()\r\n      })\r\n    })\r\n\r\n    //选项卡的点击事件\r\n    const tabClick=(index)=>{\r\n      //点击切换的时候，\r\n      let types=['sales','new','recommend']\r\n      currentType.value=types[index]\r\n      //点击不同的选项卡 它的高度应该是重新计算新的\r\n      nextTick(()=>{\r\n        //重新计算高度  存在才调用 不存在不调用\r\n        bscroll && bscroll.refresh()\r\n      })\r\n    }\r\n    //界面任何一个变量有变化，都会监听触发\r\n    watchEffect(()=>{\r\n      //数据变化，页面刷新完之后，延迟刷新\r\n        nextTick(()=>{\r\n            //重新计算高度  存在才调用 不存在不调用\r\n          bscroll && bscroll.refresh()\r\n        })\r\n    })\r\n\r\n    //点击回到顶部的按钮 ，父接受子传递过来的方法\r\n    const bTop=()=>{\r\n         // console.log(1)\r\n        bscroll.scrollTo(0,0,500)   //自带的api，可以滚动到指定的位置\r\n    }\r\n\r\n    return {recommends,tabClick,goods,showGoods,isTabFixed,banref,isShowBackTop,bTop\r\n    ,banners\r\n    }\r\n  },\r\n\r\n  components:{\r\n    HomeSwiper,\r\n    GoodsList,\r\n    NavBar,\r\n    RecommendView,\r\n    TabControl,\r\n    BackTop\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.main{\r\n  position: relative;\r\n  height: 100vh;\r\n}\r\n  .banners{\r\n    width: 100%;\r\n    height: auto;\r\n  }\r\n  .wrapper{\r\n    position: absolute;\r\n    top: 45px;\r\n    bottom: 50px;\r\n    left: 0;\r\n    right: 0;\r\n    overflow: hidden;\r\n  }\r\n  .content{\r\n\r\n  }\r\n</style>"],"sourceRoot":""}]}